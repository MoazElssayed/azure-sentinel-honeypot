Syslog
| where TimeGenerated >= ago(24h)
| where Facility == "auth" and SyslogMessage startswith "Failed password for"
| extend AttackerIP = extract(@"\b\d{1,3}(\.\d{1,3}){3}\b", 0, SyslogMessage)
| summarize FailureCount = count() by AttackerIP, Host = HostName
| order by FailureCount desc
